(window.webpackJsonp=window.webpackJsonp||[]).push([[149],{"./app/scripts/controller/memberHomePage.js":function(e,t,a){function s(e,t){return null!=e?t(e):void 0}const i=a("./packages/jquery/index.js"),{Auth:n}=a("./app/scripts/db/auth.js"),{l:r}=a("./app/scripts/lib/localize.js"),{TrelloStorage:o}=a("./packages/storage/index.ts"),{Apdex:l,Analytics:m,getScreenFromUrl:c}=a("./packages/atlassian-analytics/index.ts"),{Util:p}=a("./app/scripts/lib/util.js"),{trackGTMEvent:d}=a("./packages/analytics/index.ts"),{isMemberOfOrg:g,getHomeLastTab:u,redirectHomeToDefaultTab:b,getHomeLastTabStorageKey:h}=a("./app/scripts/controller/memberPageHelpers.js"),{navigate:w}=a("./app/scripts/controller/navigate.js"),{importWithRetry:f}=a("./packages/use-lazy-component/index.ts");let y=!1,S=null,k=!1;i(window).on("popstate",(()=>k=!0));e.exports.memberHomePage=function(e={}){const{orgname:t,showHomeBoardsTab:v,showGettingStarted:H,templatesData:j,titleKey:M}=e,{ModelCache:T}=a("./app/scripts/db/model-cache.js");if(!n.isLoggedIn())return this.displayErrorPage();j&&"all"===j.category&&!j.shortLink&&w("/templates",{trigger:!0,replace:!0});const B=(()=>{switch(!1){case!v:return"memberBoards";default:return"memberHome"}})();return j||l.start({task:B}),T.waitFor("Member",n.myId(),(()=>f((()=>a.e(151).then(a.t.bind(null,"./app/scripts/controller/memberPage.js",7)))).then((({memberPage:e})=>{const f=p.idToDate(n.myId())>p.dateBefore({minutes:3}),D=s(n.me(),(e=>e.isDismissed("sent-possible-new-signup-event")));(S||!D&&f)&&(d({event:"trello.possibleNewSignup",ed:s(n.me(),(e=>e.getEmailDomain()))}),s(n.me(),(e=>e.dismiss("sent-possible-new-signup-event"))));const x=u.call(this);if(!(t||v||H||j||!x||"/"===x||k))return k=!1,l.cancel({task:B}),y=l.isInitialLoad&&l.initialUrl===window.location.href,w(x,{trigger:!0,replace:!0});if(k&&o.set(h(),window.location.pathname),t&&!g(t))return b.call(this);!function(e,t,i,n){var r;const{ModelCache:o}=a("./app/scripts/db/model-cache.js");let l="",p={};if(e&&t&&!i)l="organizationBoardsHomeScreen",p={teamId:s(o.findOne("Organization","name",e),(e=>e.id))};else if(e||!t||i||n)if(e||t||!i||n)if(e||t||i||n){if(!n||e||t||i)return;l="organizationGettingStartedScreen"}else l="memberHomeScreen";else l="templateGalleryScreen";else l="memberBoardsHomeScreen";m.sendOperationalEvent({action:"rendered",actionSubject:l,source:c(),containers:{organization:{id:null===(r=p)||void 0===r?void 0:r.teamId}}})}(t,v,j,H),k=!1,null==S&&(S=i.cookie("simulateNewUser"));const z={username:"me",loadFn:t||v||!j?"loadMemberBoardsData":"loadMinimumMemberDataForTemplatePage",viewClassName:"MemberHomeView",getLocation:e=>this.getMemberBoardsUrl(e,t,v,j,H),titleKey:M||"boards",orgname:t,showHomeBoardsTab:v,showGettingStarted:H,templatesData:j};return e.call(this,z).then((()=>{const e=void 0===t?r(["page title","home"]):!t&&v?r(["page title","boards"]):s(T.findOne("Organization","name",t),(e=>e.get("displayName")));return this.title(e)})).tap((function(){if("memberBoards"===B)return y&&l.resetInitialState(),l.stop({task:B}),y=!1})).done()}))))}}}]);
//# sourceMappingURL=member-home-page.fc38f19e4612f294490e.js.map